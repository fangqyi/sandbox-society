

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Quickstart &mdash; Neural MMO 1.3 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Ideology" href="ideology.html" />
    <link rel="prev" title="Welcome to the Platform!" href="overview.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Neural MMO
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">User Guide:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html"> Welcome to the Platform!</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview.html#ags-overview"> Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview.html#ags-quickstart"> Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview.html#ags-tutorials"> Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview.html#ags-namesake"> Namesake</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview.html#ags-version-history"> Version History</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview.html#ags-ideology"> Ideology</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview.html#ags-authorship-license-disclaimer"> Authorship, License, Disclaimer</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview.html#ags-assets"> Assets</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#"> Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="#ags-training-from-scratch"> Training from scratch</a></li>
<li class="toctree-l1"><a class="reference internal" href="#ags-the-io-api"> The IO API</a></li>
<li class="toctree-l1"><a class="reference internal" href="#ags-distributed-computation-with-ascend"> Distributed computation with Ascend</a></li>
<li class="toctree-l1"><a class="reference internal" href="ideology.html"> Ideology</a></li>
</ul>
<p class="caption"><span class="caption-text">API Reference:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="autodoc/modules.html">API Reference</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Neural MMO</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li> Quickstart</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/neural-mmo.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <p><img alt="env" src="_images/banner.png" /></p>
<div class="section" id="ags-quickstart">
<h1><img alt="ags" src="_images/ags.png" /> Quickstart<a class="headerlink" href="#ags-quickstart" title="Permalink to this headline">¶</a></h1>
<p><strong>Installation:</strong> The master branch will always contain the latest stable version. <em>Users should not fork cowboy branches.</em> These are hyperagressive dev branches for contributors. They are not bleeding edge builds and may be flammable.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#Download the Neural MMO environment</span>
<span class="c1">#We assume a Python 3.7+ setup with Anaconda pip</span>
<span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">jsuarez5341</span><span class="o">/</span><span class="n">neural</span><span class="o">-</span><span class="n">mmo</span> <span class="o">&amp;&amp;</span> <span class="n">cd</span> <span class="n">neural</span><span class="o">-</span><span class="n">mmo</span>

<span class="c1">#Installation options:</span>
<span class="c1">#   --no-client:   Omit the Embyr 3D Unity client</span>
<span class="c1">#   --virtual-env: Install in a virtual env</span>
<span class="n">python</span> <span class="n">scripts</span><span class="o">/</span><span class="n">setup</span><span class="o">.</span><span class="n">py</span>

<span class="c1">#Run the pretrained demo model to test the installation</span>
<span class="n">python</span> <span class="n">Forge</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">render</span>

<span class="c1">#Open the client in a separate terminal</span>
<span class="c1">#You will need to rerun this if you restart the environment</span>
<span class="o">./</span><span class="n">client</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
</div>
<div class="section" id="ags-training-from-scratch">
<h1><img alt="ags" src="_images/ags.png" /> Training from scratch<a class="headerlink" href="#ags-training-from-scratch" title="Permalink to this headline">¶</a></h1>
<p>Next, we will get familiar with the baseline parameters and train a model from scratch. Open up experiments.py, which contains all of the training configuration options. First, we’ll disable the test mode flags:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">LOAD</span> <span class="o">=</span> <span class="bp">False</span>
<span class="n">TEST</span> <span class="o">=</span> <span class="bp">False</span>
<span class="n">BEST</span> <span class="o">=</span> <span class="bp">False</span>
</pre></div>
</div>
<p>Our baseline was trained on a 12 core machine. Your CPU probably does not have this many. To use 4 cores instead:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">NGOD</span> <span class="o">=</span> <span class="mi">4</span>
</pre></div>
</div>
<p>Now we can train a model:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">Forge</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>If you leave it running, you will see the reward steadily increasing. The baseline model gets to &gt;23 average lifetime after training for several days on 12 cores. Once you are satisfied, enable testing flags and run with rendering enabled to view learned policies. Learning not to run into lava is a good sanity check.</p>
</div>
<div class="section" id="ags-the-io-api">
<h1><img alt="ags" src="_images/ags.png" /> The IO API<a class="headerlink" href="#ags-the-io-api" title="Permalink to this headline">¶</a></h1>
<p>On the surface, Neural MMO follows the OpenAI Gym API:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<p>from forge.blade.core.realm import Realm
from experiments import Experiment, Config</p>
<dl>
<dt>if __name__ == ‘__main__’:</dt><dd><p>config = Experiment(‘demo’, Config).init()</p>
<p>env = Realm(config, <a href="#id1"><span class="problematic" id="id2">*</span></a>args)
obs, rewards, dones, infos = env.reset()</p>
<dl class="simple">
<dt>while not done:</dt><dd><p>actions = somePolicy(obs)
obs, rewards, dones, info = env.step(actions)</p>
</dd>
</dl>
</dd>
</dl>
<p>However, the actual contents of <em>obs, rewards, dones, info</em> is nonstandard by necessity. Gym isn’t built for multiagent environments – and certainly not for ones with complex hierarchical observation and action spaces. You’re free to develop your own methods for handling these, but we’ve already done all that work for you. Let’s make use of the core IO libraries:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<p>from forge.blade.core.realm import Realm
from experiments import Experiment, Config</p>
<dl>
<dt>if __name__ == ‘__main__’:</dt><dd><p>config = Experiment(‘demo’, Config).init()</p>
<p>env = Realm(config, <a href="#id3"><span class="problematic" id="id4">*</span></a>args)
obs, rewards, dones, infos = env.reset()</p>
<dl>
<dt>while not done:</dt><dd><p>input, _ = io.inputs(obs, rewards, dones, <a href="#id5"><span class="problematic" id="id6">*</span></a>args)
output   = somePolicy(input)</p>
<p>actions = io.outputs(output)
obs, rewards, dones, info = env.step(actions)</p>
</dd>
</dl>
</dd>
</dl>
<p>We’re almost done. The IO API handles batching, normalization, and serialization. The only remaining issue is that <em>somePolicy</em> must handle hierarchical data and variable action spaces. Let’s use the Ethyr prebuilt IO modules:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<p>from forge.blade.core.realm import Realm
from experiments import Experiment, Config
import torch</p>
<dl>
<dt>if __name__ == ‘__main__’:</dt><dd><p>config = Experiment(‘demo’, Config).init()</p>
<p>env = Realm(config, <a href="#id7"><span class="problematic" id="id8">*</span></a>args)
obs, rewards, dones, infos = env.reset()</p>
<dl>
<dt>policy = torch.nn.Sequential(</dt><dd><p>ethyr.Input(<a href="#id9"><span class="problematic" id="id10">*</span></a>args),
ethyr.Output(<a href="#id11"><span class="problematic" id="id12">*</span></a>args)</p>
</dd>
<dt>while not done:</dt><dd><p>input, _ = io.inputs(obs, rewards, dones, <a href="#id13"><span class="problematic" id="id14">*</span></a>args)
output   = policy(input)</p>
<p>actions = io.outputs(output)
obs, rewards, dones, info = env.step(actions)</p>
</dd>
</dl>
</dd>
</dl>
<p>And there you have it! You can insert your own model between the input and output networks without having to deal with nonstandard structured data. However, this only covers the forward pass. We haven’t discussed rollout collection, training, or any population based methods. For a fully featured and well documented example, hop over to /projekt in the environment repo.</p>
</div>
<div class="section" id="ags-distributed-computation-with-ascend">
<h1><img alt="ags" src="_images/ags.png" /> Distributed computation with Ascend<a class="headerlink" href="#ags-distributed-computation-with-ascend" title="Permalink to this headline">¶</a></h1>
<p>Ascend is a lightweight wrapper on top of the excellent Ray distributed computing library. The core paradigm is to model each <em>layer</em> of hardware – cluster, server, core – by subclassing the Ascend object. Let’s first implement a remote client (Sword) without using Ascend. In order to keep track of several remote clients, we will also create a server (God).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<p>import ray, time</p>
<p>&#64;ray.remote
class Sword:</p>
<blockquote>
<div><dl class="simple">
<dt>def __init__(self, idx):</dt><dd><p>self.idx = idx</p>
</dd>
<dt>def step(self):</dt><dd><p>time.sleep(1)
return self.idx</p>
</dd>
</dl>
</div></blockquote>
<dl class="simple">
<dt>class God:</dt><dd><dl class="simple">
<dt>def __init__(self, n=5):</dt><dd><p>self.disciples = [Sword.remote(i) for i in range(n)]</p>
</dd>
<dt>def step(self):</dt><dd><p>clientData = ray.get([d.step.remote() for d in self.disciples])
print(clientData) #[0, 1, 2, 3, 4]</p>
</dd>
</dl>
</dd>
<dt>if __name__ == ‘__main__’:</dt><dd><p>ray.init()
God().step()</p>
</dd>
</dl>
<p>Ascend enables us to do all of this without manually writing loops over hardware:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<p>from forge.trinity.ascend import Ascend
import ray, time</p>
<p>&#64;ray.remote
class Sword:</p>
<blockquote>
<div><dl class="simple">
<dt>def __init__(self, idx):</dt><dd><p>self.idx = idx</p>
</dd>
<dt>def step(self):</dt><dd><p>time.sleep(1)
return self.idx</p>
</dd>
</dl>
</div></blockquote>
<dl class="simple">
<dt>class God(Ascend):</dt><dd><dl class="simple">
<dt>def __init__(self, n=5):</dt><dd><p>super().__init__(Sword, n)</p>
</dd>
<dt>def step(self):</dt><dd><p>clientData = super().step()
print(clientData) #[0, 1, 2, 3, 4]</p>
</dd>
</dl>
</dd>
<dt>if __name__ == ‘__main__’:</dt><dd><p>ray.init()
God().step()</p>
</dd>
</dl>
<p>The source is only a few hundred lines and isn’t very useful in toy examples. Ascend really shines in more complex environments that already have too many moving parts:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<p>from forge.trinity.ascend import Ascend, runtime, waittime
import ray, time</p>
<p>&#64;ray.remote
class Sword(Ascend):</p>
<blockquote>
<div><dl class="simple">
<dt>def __init__(self, idx):</dt><dd><p>super().__init__(None, 0)
self.idx = idx</p>
</dd>
</dl>
<p>&#64;runtime
def step(self, coef, bias):</p>
<blockquote>
<div><p>time.sleep(1)
return coef*self.idx + bias</p>
</div></blockquote>
</div></blockquote>
<dl>
<dt>class God(Ascend):</dt><dd><dl class="simple">
<dt>def __init__(self, n=5):</dt><dd><p>super().__init__(Sword, n)</p>
</dd>
<dt>def update(self):</dt><dd><p>time.sleep(1)</p>
</dd>
</dl>
<p>&#64;runtime
def step(self):</p>
<blockquote>
<div><dl class="simple">
<dt>asyncHandles = super().distrib(</dt><dd><p>2,
[4, 3, 2, 1, 0],
shard=(False, True))</p>
</dd>
</dl>
<p>self.update()
clientData = super().sync(asyncHandles)
print(clientData) #[4, 5, 6, 7, 8]</p>
</div></blockquote>
</dd>
<dt>if __name__ == ‘__main__’:</dt><dd><p>ray.init()
God().step()</p>
</dd>
</dl>
<p>Like before, we have a server interacting with five remote clients. This time, the <em>coef</em> argument is shared among clients while the <em>bias</em> argument is sharded among them. Additionally, we are using the computation time of the clients to perform additional work in the server side <em>update()</em> function. And we are also logging performance statistics, specifically time spent performing useful computation vs time spent waiting, for both layers. The Neural MMO demo has a third infrastructure layer for the cluster. Even in this toy example, Ascend is saving us quite a bit of code. In a full research environment, we have found it an indispensable tool. Welcome, Ascendant!</p>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="ideology.html" class="btn btn-neutral float-right" title="Ideology" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="overview.html" class="btn btn-neutral float-left" title="Welcome to the Platform!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Joseph Suarez

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    

  <style>
    /* Sidebar header (and topbar for mobile) */
    .wy-side-nav-search, .wy-nav-top {
      background: #001010;
    }
    /* Sidebar */
    .wy-nav-side {
      background: #001818;
    }
    .wy-nav-content {
      background: #002020;
    }
    .wy-nav-content-wrap {
      background: #001818;
    }

    .wy-table-responsive table td, .wy-table-responsive table th {
      /* !important prevents the common CSS stylesheets from
             overriding this as on RTD they are loaded after this stylesheet */
      white-space: normal !important;
    }
       
    .wy-table-responsive {
      overflow: visible !important;
    }

    //This one is the one that does something?
    .row-odd {
      background: #ff0000;
    }

    .row-even {
      background: #00ffff;
    }

    /* Top line */
    hr {
      border-top-color: teal;
      border-top-style: solid;
      border-top-width: 3px;
    }

    /* ****** Begin Tables ****** */

    /*Don't even think about changing this.
    Spent 3 hours pulling this from an rtd bitbucket PR*/ 
    wy-table-odd td, .wy-table-striped tr:nth-child(2n-1) td, .rst-content table.docutils:not(.field-list) tr:nth-child(2n-1) td {
      background-color: #001818;
    }

    wy-table-even td, .wy-table-striped tr:nth-child(2n) td, .rst-content table.docutils:not(.field-list) tr:nth-child(2n) td {
      background-color: #002020;
    }

    /* Outer table */
    .wy-table-bordered-all, .rst-content table.docutils {
      border: 1px solid #0f0;
        border-top-color: lime;
        border-top-style: solid;
        border-top-width: 1px;
        border-right-color: lime;
        border-right-style: solid;
        border-right-width: 1px;
        border-bottom-color: lime;
        border-bottom-style: solid;
        border-bottom-width: 1px;
        border-left-color: lime;
        border-left-style: solid;
        border-left-width: 1px;
        border-image-outset: 0;
        border-image-repeat: stretch;
        border-image-slice: 100%;
        border-image-source: none;
        border-image-width: 1;
    }

    /* Table header underline */
    .wy-table thead th, .rst-content table.docutils thead th, .rst-content table.field-list thead th {
        font-weight: bold;
        border-bottom-color: rgb(055, 0, 0);
        border-bottom-style: solid;
        border-bottom-width: 0px;
    }

    /* Inner table border */
    .wy-table-bordered-all td, .rst-content table.docutils td {
        border-bottom-color: rgb(255, 0, 0);
        border-bottom-style: solid;
        border-bottom-width: 0px;
        border-left-color: rgb(255, 0, 0);
        border-left-style: solid;
        border-left-width: 0px;
    }
    /* ****** End Tables ****** */

    /* ****** Start selection for left sidebar ****** */
    .wy-menu-vertical li.current{
      background: #003030;
    }

    .wy-menu-vertical li.toctree-l1.current > a{
      background: #002020;
      border-top-color: lime;
      border-top-style: solid;
      border-top-width: 3px;
      border-bottom-color: lime;
      border-bottom-style: solid;
      border-bottom-width: 3px;
      
    }

    .rst-content pre.literal-block, .rst-content div[class^="highlight"] {
      border-top-color: #00ff00;
      border-top-style: solid;
      border-top-width: 1px;
      border-right-color: #00ff00;
      border-right-style: solid;
      border-right-width: 1px;
      border-bottom-color: #00ff00;
      border-bottom-style: solid;
      border-bottom-width: 1px;
      border-left-color: #00ff00;
      border-left-style: solid;
      border-left-width: 1px;
      border-image-outset: 0;
      border-image-repeat: stretch;
      border-image-slice: 100%;
      border-image-source: none;
      border-image-width: 1;
    }

    .wy-menu-vertical li.toctree-l2.current li.toctree-l3 > a {
      display: block;
      background: #002020;
      padding: .4045em 4.045em;
    }

    .wy-menu-vertical li.toctree-l2.current > a {
      background: #002020;
      padding: .4045em 2.427em;
    }

    .wy-menu-vertical li.toctree-l3.current li.toctree-l4 > a {
      display: block;
      background: #002020;
      padding: .4045em 5.663em;
    }

    .wy-menu-vertical li.toctree-l2.current li.toctree-l3 > a {
      display: block;
      background: #002020;
      padding: .4045em 4.045em;
    }

    /* ****** End selection for left sidebar ****** */

    /* Bullet(?) blocks */
    .rst-content dl:not(.docutils) dt {
      display: table;
      margin: 6px 0;
      margin-top: 6px;
      font-size: 90%;
      line-height: normal;
      background: #003030;
      color: #008888;
      border-top: solid 6px #001818;
      padding: 6px;
      position: relative;
    }

    /* ****** Start Code Blocks ****** */
    .highlight-python {
      background: #00ff00;
      border: #00ff00;
    }

    .highlight {
      background: #003030;
      color: #00fafa;
    }
    /* ****** End Code Blocks ****** */

    /* Buttons */
    .btn-neutral {
      background-color: #008888 !important;
      color: #003030 !important;
    }

    .rst-content dl:not(.docutils) dl dt {
      margin-bottom: 6px;
      border-left: solid 0px #00000;
      background: #003030;
      color: #008888;
      }

    code, .rst-content tt, .rst-content code {
      background-color: #002020;
      border-top-width: 0px;
      border-bottom-width: 0px;
      border-left-width: 0px;
      border-right-width: 0px;
    }

    .rst-content dl:not(.docutils) dl dt {
      border-left-color: #002020;
    }

    .rst-content tt, .rst-content tt, .rst-content code {
      color: #00aaaa;
    }

    .rst-content tt.xref, a .rst-content tt, .rst-content tt.xref, .rst-content code.xref, a .rst-content tt, a .rst-content code {
      color:#00aaaa;
    }

    .wy-menu-vertical li.toctree-l2 a, .wy-menu-vertical li.toctree-l3 a, .wy-menu-vertical li.toctree-l4 a {
      color:#008800;
    }

    .wy-menu-vertical li.on a, .wy-menu-vertical li.current > a {
      color: #008888;
    }

    .wy-menu-vertical li.current a {
      border-right: solid 1px #002020;
      padding: .4045em 2.427em;
    }

    footer {
      color: teal;
    }

    p {
      color: #00aaaa;
    }
    h1 {
      color: lime;
    }

    h2 {
      color: aqua;
    }

    h3 {
      color: teal;
    }

    h4 {
      color: blue;
    }

    ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    li {
      padding-left: 1em; 
      text-indent: -.7em;
    }

    li {
      content: "• ";
      color: blue; /* or whatever color you prefer */
      }

    a:link {
      color: lime;
    }

    /* visited link */
    a:visited {
      color: lime;
    }

  </style>


</body>
</html>